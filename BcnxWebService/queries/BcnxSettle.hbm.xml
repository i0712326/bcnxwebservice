<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
 "-//Hibernate/Hibernate Mapping DTD//EN"
 "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"> 
<hibernate-mapping>
	<query name="getBcnxSettle">
		from BcnxSettle b where b.rrn = :rrn and b.mti = :mti and b.stan = :stan and b.slot = :slot
	</query>
	<query name="getBcnxSettles">
		from BcnxSettle bs where bs.card like :card and bs.rrn like :rrn and bs.stan like :stan and bs.date between :start and :end
	</query>
	<query name="countBcnxSettles">
		select count(bs) from BcnxSettle bs where bs.card like :card and bs.rrn like :rrn and bs.stan like :stan and bs.date between :start and :end
	</query>
	<!--  settlement calculation -->
	<query name="getMaxDate">
		select max(bs.date) as date from BcnxSettle bs order by bs.date desc
	</query>
	<query name="getBcnxFinIss">
		from BcnxSettle b where b.date = :date and b.iss = :id and b.res = :res and b.rrn 
			not in (select bb.rrn from BcnxSettle bb where bb.date =:date and bb.iss = :id and bb.mti = :mti ) 
			order by b.time 
	</query>
	<query name="getBcnxFinAcq">
		from BcnxSettle b where b.date = :date and b.acq = :id and b.res = :res and b.rrn 
				not in (select bb.rrn from BcnxSettle bb where bb.date =:date and bb.acq = :id and bb.mti = :mti ) 
				order by b.time
	</query>
	<query name="getBcnxRev">
		from BcnxSettle b where b.date = :date and ( b.acq =:id or b.iss =:id )and b.res = :res and b.mti = :mti order by b.time
	</query>
	<query name="">
		 from BcnxSettle b where b.date = :date and ( b.acq =:id or b.iss =:id )and b.res !=:res and b.mti = :mti and b.rrn not in 
				( select bb.rrn from BcnxSettle bb where bb.date =:date and bb.acq = :id and bb.mti = :mti ) order by b.time
	</query>
</hibernate-mapping>